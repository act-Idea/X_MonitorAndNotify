<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
</head>
<body>
  <header>
    <div class="brand">モニターダッシュボード</div>
    <nav aria-label="メインナビゲーション">
      <a href="/dashboard" title="ダッシュボード">ダッシュボード</a>
      <a href="/setting" title="モニター設定">モニター設定</a>
      <a href="/results" title="結果一覧">結果一覧</a>
      <a href="/logout" title="ログアウト">ログアウト</a>
    </nav>
    <div style="color:#cbd5e1;font-size:14px;margin-left:16px"> 
      {% if user_name %}
        ようこそ {{ user_name }} さん（ID: {{ user_id }}）
      {% else %}
        ようこそ (ID: {{ user_id }})
      {% endif %}
    </div>
  </header>

  <main class="container">
    <section class="actions" aria-label="ページ操作">
      <h1>モニター設定一覧</h1>
      <button class="btn" onclick="location.href='/setting'">モニター設定を追加</button>
    </section>

    <section class="panel" aria-label="モニター設定テーブル">
      <table role="table" aria-label="モニター設定一覧">
        <thead>
          <tr>
            <th scope="col">モニター名</th>
            <th scope="col">キーワード</th>
            <th scope="col">通知先</th>
            <th scope="col">条件概要</th>
            <th scope="col">有効/無効</th>
            <th scope="col">操作</th>
          </tr>
        </thead>
        <tbody>
          {% if monitors and monitors|length > 0 %}
            {% for m in monitors %}
              <tr>
                <td data-label="モニター名">{{ m.monitor_name }}</td>
                <td data-label="キーワード">
                  {% if m.keywords %}
                    {% for kw in m.keywords %}
                      <span class="tag">{{ kw }}</span>
                    {% endfor %}
                  {% endif %}
                </td>
                <td data-label="通知先"><span class="muted">{{ m.notify_email or '-' }}</span></td>
                <td data-label="条件概要">--</td>
                <td data-label="有効/無効">
                  <label class="toggle" aria-label="{{ m.monitor_name }} を有効化">
                    <input type="checkbox" class="toggle-checkbox" data-monitor-id="{{ m.monitor_id }}" {% if m.is_enabled %}checked{% endif %} />
                    <span class="slider"></span>
                  </label>
                </td>
                <td data-label="操作">
                  <div class="row-actions">
                    <button class="btn small outline" onclick="location.href='/setting?id={{ m.monitor_id }}'">編集</button>
                    <button class="btn small outline" onclick="location.href='/results?monitor={{ m.monitor_id }}'">結果一覧</button>
                  </div>
                </td>
              </tr>
            {% endfor %}
          {% else %}
            <tr>
              <td colspan="6" style="text-align:center;color:var(--muted)">モニター設定が見つかりません。</td>
            </tr>
          {% endif %}
        </tbody>
      </table>
    </section>

    <footer>
      © 2025 Monitoring App — ダッシュボード
    </footer>
  </main>
  <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>
</html>
